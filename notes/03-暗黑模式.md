## 暗黑模式

### 安装 next-themes
> https://ui.shadcn.com/docs/dark-mode/next

它是一个 Next.js 插件，用于在 Next.js 应用中实现主题切换功能。
```bash
pnpm add next-themes
```

### 创建 ThemeProvider
在 `components` 文件夹下新建 `theme-provider.tsx` 文件：

```tsx
"use client"

import * as React from "react"
import { ThemeProvider as NextThemesProvider } from "next-themes"
6
export function ThemeProvider({
  children,
  ...props
}: React.ComponentProps<typeof NextThemesProvider>) {
  return <NextThemesProvider {...props}>{children}</NextThemesProvider>
}
```

### 包裹 RootLayout
打开 `app/layout.tsx`，用我们刚才写的 `ThemeProvider` 包裹整个应用。
**注意**: 还要给 `html` 标签加上 `suppressHydrationWarning`，这是为了防止 Next.js 在服务端渲染和客户端渲染主题不一致时报错。

```tsx
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";
import { ThemeProvider } from "@/components/theme-provider"; // 引入

// ... (字体定义保持不变)

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="zh-CN" suppressHydrationWarning>
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        <ThemeProvider
          attribute="class"
          defaultTheme="system"
          enableSystem
          disableTransitionOnChange
        >
          {children}
        </ThemeProvider>
      </body>
    </html>
  );
}
```

- attribute="class" 确保主题类名正确应用到 `html` 标签。
- defaultTheme="system" 允许用户系统设置自动切换主题。
- enableSystem 开启系统主题监听。
- disableTransitionOnChange 避免切换时的闪烁。

## 3. 制作主题切换按钮

### 3.2 创建 ModeToggle 组件
在 `components` 文件夹下新建 `mode-toggle.tsx`：

```tsx
"use client"

import { Moon, Sun } from "lucide-react" // 引入图标
import { useTheme } from "next-themes"

import { Button } from "@/components/ui/button"

export function ModeToggle() {
    const { theme, setTheme } = useTheme()

    return (
        <Button variant="ghost" size="icon" className="rounded-full" onClick={() => theme === "dark" ? setTheme("light") : setTheme("dark")}>
            <Sun className="h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"  />
            <Moon className="absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"/>
        </Button>
    )
}
```

### next-themes 相关
- useTheme 从 next-themes 引入，用于获取当前主题和切换主题。
- theme 和 setTheme 分别用于获取当前主题和切换主题。
- theme === "dark" 检查当前是否为暗黑模式。
- setTheme("light") 切换到亮色模式。
- setTheme("dark") 切换到暗黑模式。


### shadcn/ui 按键相关
- variant="ghost" 使按钮看起来更像一个图标。
- size="icon" 确保图标大小合适。
  - 还有其他例如：
    - icon-xs
    - icon-sm
    - icon
    - icon-lg
- onClick 事件触发主题切换。
- rounded-full 使按钮形状为圆角。
